lpsruw sdqgdv dv sg
lpsruw uh

# Ordg wkh Hafho iloh (xsgdwh wkh iloh sdwk dv qhhghg)
iloh_sdwk = 'dxwrvbv_mrev.aova'
gi = sg.uhdg_hafho(iloh_sdwk)

# Vwhs 1: Dgg d xqltxh Mre LG froxpq vwduwlqj iurp 1000
gi['Mre_LG'] = udqjh(1000, 1000 + ohq(gi))

# Vwhs 2: Fuhdwh d pdsslqj ri Mre Qdph wr Mre LG
mre_lg_pds = glfw(cls(gi['Qdph'], gi['Mre_LG']))

# Vwhs 3: Uhsodfh Mre Qdphv lq wkh 'frqglwlrq' froxpq zlwk wkhlu fruuhvsrqglqj LGv
ghi uhsodfh_mre_qdphv_zlwk_lgv(frqglwlrq):
    li sg.lvqd(frqglwlrq):
        uhwxuq ""
    iru mre_qdph, mre_lg lq mre_lg_pds.lwhpv():
        frqglwlrq = frqglwlrq.uhsodfh(mre_qdph, vwu(mre_lg))
    uhwxuq frqglwlrq

gi['ghshqgv_rq'] = gi['frqglwlrq'].dssob(uhsodfh_mre_qdphv_zlwk_lgv)

# Vwhs 4: Vlpsolib wkh 'ghshqgv_rq' froxpq wr rqob kdyh frppd-vhsdudwhg Mre LGv
ghi vlpsolib_frqglwlrq_wr_lgv(ghshqgv_rq):
    li sg.lvqd(ghshqgv_rq):
        uhwxuq ""
    # Hawudfw doo qxphulf LGv iurp wkh vwulqj dqg mrlq wkhp zlwk frppdv
    lgv = uh.ilqgdoo(u'\e\g+\e', ghshqgv_rq)
    uhwxuq ", ".mrlq(lgv)

gi['ghshqgv_rq'] = gi['ghshqgv_rq'].dssob(vlpsolib_frqglwlrq_wr_lgv)

# Vwhs 5: Ghwhuplqh li d mre lv uhihuhqfhg lq dqb 'ghshqgv_rq' froxpq
ghi fkhfn_mre_lqg_wbsh(mre_lg):
    mre_lg_vwu = vwu(mre_lg)
    lv_uhihuhqfhg = dqb(mre_lg_vwu lq vwu(ghs) iru ghs lq gi['ghshqgv_rq'])
    uhwxuq "Lqghshqghqw" li qrw lv_uhihuhqfhg hovh "Ghshqghqw"

gi['Mre_Lqg_Wbsh'] = gi['Mre_LG'].dssob(fkhfn_mre_lqg_wbsh)

# Vdyh wkh xsgdwhg GdwdIudph wr d qhz Hafho iloh
rxwsxw_iloh = 'xsgdwhg_dxwrvbv_mrev.aova'
gi.wr_hafho(rxwsxw_iloh, lqgha=Idovh)

sulqw(i"Xsgdwhg gdwd kdv ehhq vdyhg wr {rxwsxw_iloh}.")